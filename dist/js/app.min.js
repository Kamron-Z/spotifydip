let playlists=[{title:"lisa",music:[]},{title:"drake",music:[]}],music=[{title:"lovely",title_org:"lovely",author:"Khalid, Billie Eilish",img:"lovely",length:Number,isLiked:!0},{title:"bad guy",title_org:"bad-guy",author:"BillieEilish",img:"badGuy",length:Number,isLiked:!0},{title:"Six Feet Under",author:"Billie Eilish",title_org:"SixFeetUnder",img:"six",length:Number,isLiked:!0},{title:"Сан Ларан",author:"Платина, дора",title_org:"СанЛаран",img:"sanLoran",length:Number,isLiked:!1},{title:"Младшая сестра",author:"дора",title_org:"МладшаяСестра",img:"doradura",length:Number,isLiked:!1},{title:"Втюрилась",author:"дора",title_org:"Втюрилась",img:"vturilas",length:Number,isLiked:!1},{title:"Дорадура",author:"дора",title_org:"Дорадура",img:"doradura",length:Number,isLiked:!1},{title:"Toxic",author:"BoyWithUke",title_org:"Toxic",img:"toxic",length:Number,isLiked:!1},{title:"MONEY",author:"LISA",title_org:"MONEY",img:"money",length:Number,isLiked:!1},{title:"I WANNA BE YOUR SLAVE",author:"Måneskin",title_org:"IWANNABEYOURSLAVE",img:"wanna",length:Number,isLiked:!1},{title:"PUSSY BOY",author:"ЕГОР КРИД",title_org:"PUSSYBOY",img:"pussy",length:Number,isLiked:!1},{title:"LIPSI HA",author:"INSTASAMKA",title_org:"LIPSIHA",img:"lipsi",length:Number,isLiked:!1},{title:"STAY (with Justin Bieber)",author:"The Kid LAROI, Justin Bieber",title_org:"stay",img:"stay",length:Number,isLiked:!1},{title:"Astronaut In The Ocean",author:"Masked Wolf",title_org:"Astronaut",img:"ocean",length:Number,isLiked:!1}];for(let e of music){let t=document.createElement("audio");t.src=`./img/music/${e.title_org}.mp3`,t.controls=!0,t.addEventListener("loadeddata",(function(){e.times=t.duration/60,e.times=e.times.toString().replace(".",":").slice(0,4)}))}music=music.map(e=>(e._id=music.indexOf(e),e)),playlists=playlists.map(e=>(e.id=playlists.indexOf(e),e)),setTimeout(()=>{let e=document.querySelector(".music-random"),t=document.querySelector(".music-liked"),i=document.querySelector(".music-all"),s=document.querySelector(".music-last"),c=document.querySelector(".music-saved"),l=document.querySelector(".audio-play"),n=document.querySelector(".audio-user-name"),r=document.querySelector(".audio-user-album"),a=document.querySelector(".saved"),o=document.body,d=document.querySelector(".body-mask"),m=[];const u=(e,t)=>{for(const i of e){let e=document.createElement("div"),s=document.createElement("p"),c=document.createElement("img"),l=document.createElement("div"),n=document.createElement("h3"),r=document.createElement("p"),a=document.createElement("div"),o=document.createElement("img"),d=document.createElement("p"),m=document.createElement("div"),u=document.createElement("img"),L=document.createElement("div"),v=document.createElement("div"),g=document.createElement("div"),p=document.createElement("div");e.classList.add("main-music"),s.classList.add("main-music-num"),c.classList.add("main-music-img"),l.classList.add("main-music-author"),a.classList.add("main-music-love"),d.classList.add("main-music-time"),m.classList.add("main-music-menu"),L.classList.add("music-modal"),s.innerText=i._id+1,c.setAttribute("src",`./img/music-pic/${i.img}.jpg`),c.id=i.id,n.innerText=i.title,r.innerText=i.author,d.innerText="none",i.isLiked?o.setAttribute("src","./img/love-blue.png"):o.setAttribute("src","./img/love-gray.png"),u.setAttribute("src","./img/music-menu.png"),i.isLiked?v.innerText="Dislike":v.innerText="Like",g.innerText="add to playlist",p.innerText="listen now",d.innerText=i.times,L.append(v,g,p),m.append(u,L),a.append(o),l.append(n,r),e.append(s,c,l,a,d,m),t.append(e),o.onclick=()=>{S(i._id)},c.onclick=()=>{f(i._id)},m.onclick=()=>{T(i._id,L,e)},v.onclick=()=>{x(i._id)},g.onclick=()=>{E(i._id)}}},L=t=>{e.innerHTML="",u(t,e)},v=e=>{t.innerHTML="",u(e.filter(e=>e.isLiked),t)},g=e=>{s.innerHTML="",u(e,s)};let p=document.querySelectorAll(".music-modal"),y=document.querySelectorAll(".main-music"),h=document.querySelector(".modal"),k=document.querySelector(".modal-cancel");const S=e=>{let t=music.filter(t=>t._id==e)[0];t.isLiked=!t.isLiked,L(music),v(music),g(m),I()},f=e=>{let t=music.filter(t=>t._id==e)[0];l.setAttribute("src",`./img/music/${t.title_org}.mp3`),n.innerText=t.title,r.innerText=t.author,m.unshift(t),m=m.filter((e,t)=>m.indexOf(e)==t),console.log(m),L(music),v(music),g(m),le()},T=(e,t,i)=>{i.classList.add("active"),t.classList.add("active"),d.classList.add("active"),o.classList.add("hidden")},x=e=>{let t=music.filter(t=>t.id==e)[0];t.isLiked=!t.isLiked,d.classList.remove("active"),o.classList.remove("hidden"),L(music),v(music),g(m),I()},E=e=>{h.classList.add("active")};d.onclick=()=>{d.classList.remove("active"),o.classList.remove("hidden");for(const e of p)e.classList.remove("active");for(const e of y)e.classList.remove("active");h.classList.remove("active")},k.onclick=()=>{h.classList.remove("active"),d.classList.remove("active"),o.classList.remove("hidden");for(const e of p)e.classList.remove("active");for(const e of y)e.classList.remove("active")},L(music),v(music),g(m);let q=document.querySelector(".playlist"),b=document.querySelector(".aside_liked"),_=document.querySelector(".list-playlist"),A=document.querySelector(".index-main"),N=document.querySelector(".playlist-main"),M=document.querySelector(".list-home"),O=document.querySelector(".intro"),B=document.querySelector(".saved-main");const H=()=>{q.innerHTML="";for(const e of playlists){let t=document.createElement("div"),i=document.createElement("a");t.classList.add("list-link"),i.setAttribute("href","#"),i.id=e.id,i.innerText=e.title,t.append(i),q.append(t),i.onclick=()=>{w(e.id)}}},I=()=>{b.innerHTML="";for(const e of music)if(1==e.isLiked){let t=document.createElement("div"),i=document.createElement("a"),s=document.createElement("span");t.classList.add("list-link"),t.classList.add("list-liked"),i.classList.add("list-link"),i.innerText=e.title,s.innerText=e.times,t.append(i,s),b.append(t),i.onclick=()=>{f(e._id)}}};H(),I(),_.onclick=()=>{var e;event.preventDefault(),_.classList.add("active"),A.classList.add("active"),N.classList.add("active"),O.classList.add("active"),B.classList.remove("active"),e=music,i.innerHTML="",u(e,i)},M.onclick=()=>{event.preventDefault(),_.classList.remove("active"),A.classList.remove("active"),N.classList.remove("active"),O.classList.remove("active"),B.classList.remove("active")};const w=e=>{let t=playlists.filter(t=>t.id==e)[0];var i;a.innerText=t.title,B.classList.add("active"),A.classList.add("active"),_.classList.remove("active"),N.classList.remove("active"),O.classList.add("active"),i=t.music,c.innerHTML="",u(i,c)};let Y=document.querySelector(".search"),U=document.querySelector(".search-done"),$=[],C=[];Y.onkeyup=()=>{if(event.target.value.trim().length>=2){let e=music.filter(e=>e.title.trim().toLowerCase().includes(event.target.value.trim().toLowerCase())),t=music.filter(e=>e.author.trim().toLowerCase().includes(event.target.value.trim().toLowerCase()));$=t.concat(e),$=$.filter((e,t)=>$.indexOf(e)==t),W($)}else $=[],W($)};const W=e=>{if(U.innerHTML="",$.length>=1){U.classList.add("active");for(const t of e){let e=document.createElement("div"),i=document.createElement("p"),s=document.createElement("p"),c=document.createElement("p");e.classList.add("search-done-item"),i.classList.add("title"),s.classList.add("author"),c.classList.add("time"),i.innerText=t.title,s.innerText=t.author,c.innerText=t.times,e.append(i,s,c),U.append(e),e.onclick=()=>{F(t._id)}}}else U.classList.remove("active")};W($);const F=e=>{let t=music.filter(t=>t._id==e)[0];console.log(t),l.setAttribute("src",`./img/music/${t.title_org}.mp3`),n.innerText=t.title,r.innerText=t.author,C.unshift(t),last_arr=C.filter((e,t)=>C.indexOf(e)==t),g(last_arr),le()};let P=document.querySelector(".modal-box"),D=document.querySelector(".modal-add input"),K=document.querySelector(".modal-btn");const R=()=>{P.innerHTML="";for(const e of playlists){let t=document.createElement("div"),i=document.createElement("p"),s=document.createElement("span");t.classList.add("modal-box-item"),i.innerText=e.title,s.innerText=e.music.length+" songs",t.append(i,s),P.append(t)}};R(),K.onclick=()=>{if(D.value.trim().length>=4){let e={title:D.value.trim(),music:[]};playlists.push(e),K.style.background="#00ECBE",D.value=""}else K.style.background="red";R(),H()};document.querySelector(".relpay");let J=document.querySelector(".prew"),V=document.querySelector(".play"),j=document.querySelector(".play_src"),G=document.querySelector(".next"),X=(document.querySelector(".any"),document.querySelector(".audio-play")),z=document.querySelector(".progress"),Q=document.querySelector(".timesong"),Z=document.querySelector(".played"),ee=document.querySelector(".progress-container"),te=0,ie=music.map(e=>e.title_org),se=music.map(e=>e.title),ce=music.map(e=>e.author);const le=e=>{V.classList.add("active"),j.src="./img/pause.svg",X.play()};V.onclick=()=>{V.classList.contains("active")?(V.classList.remove("active"),j.src="./img/play.svg",X.pause()):le()};const ne=()=>{te>=ie.length-1?te=0:te++,n.innerText=se[te],r.innerText=ce[te],X.src=`./img/music/${ie[te]}.mp3`,le()};G.onclick=()=>{ne()};J.onclick=()=>{te<=0?te=ie.length-1:te--,n.innerText=se[te],r.innerText=ce[te],X.src=`./img/music/${ie[te]}.mp3`,le()};X.addEventListener("timeupdate",e=>{let{duration:t,currentTime:i}=e.srcElement,s=i/t*100;z.style.width=s+"%",Q.innerText=(t/60).toFixed(2)+"min",Q.innerText=Q.innerText.replace(".",":"),Z.innerText=(i/60).toFixed(2)+"min",Z.innerText=Z.innerText.replace(".",":")});ee.addEventListener("click",e=>{let t=e.target.offsetWidth,i=e.offsetX,s=X.duration;X.currentTime=i/t*s}),X.addEventListener("ended",ne)},500);