let playlists=[{title:"lisa",music:[]},{title:"drake",music:[]}],music=[{title:"lovely",title_org:"lovely",author:"Khalid, Billie Eilish",img:"lovely",length:Number,isLiked:!0},{title:"bad guy",title_org:"bad-guy",author:"BillieEilish",img:"badGuy",length:Number,isLiked:!0},{title:"Six Feet Under",author:"Billie Eilish",title_org:"SixFeetUnder",img:"six",length:Number,isLiked:!0},{title:"Сан Ларан",author:"Платина, дора",title_org:"СанЛаран",img:"sanLoran",length:Number,isLiked:!1},{title:"Младшая сестра",author:"дора",title_org:"МладшаяСестра",img:"doradura",length:Number,isLiked:!1},{title:"Втюрилась",author:"дора",title_org:"Втюрилась",img:"vturilas",length:Number,isLiked:!1},{title:"Дорадура",author:"дора",title_org:"Дорадура",img:"doradura",length:Number,isLiked:!1},{title:"Toxic",author:"BoyWithUke",title_org:"Toxic",img:"toxic",length:Number,isLiked:!1},{title:"MONEY",author:"LISA",title_org:"MONEY",img:"money",length:Number,isLiked:!1},{title:"I WANNA BE YOUR SLAVE",author:"Måneskin",title_org:"IWANNABEYOURSLAVE",img:"wanna",length:Number,isLiked:!1},{title:"PUSSY BOY",author:"ЕГОР КРИД",title_org:"PUSSYBOY",img:"pussy",length:Number,isLiked:!1},{title:"LIPSI HA",author:"INSTASAMKA",title_org:"LIPSIHA",img:"lipsi",length:Number,isLiked:!1},{title:"STAY (with Justin Bieber)",author:"The Kid LAROI, Justin Bieber",title_org:"stay",img:"stay",length:Number,isLiked:!1},{title:"Astronaut In The Ocean",author:"Masked Wolf",title_org:"Astronaut",img:"ocean",length:Number,isLiked:!1}],musicId=music.map(e=>(e.id=music.indexOf(e),e)),music_random=document.querySelector(".music-random"),music_liked=document.querySelector(".music-liked"),music_last=document.querySelector(".music-last"),music_play=document.querySelector(".audio-play"),music_name=document.querySelector(".audio-user-name"),music_author=document.querySelector(".audio-user-album"),body=document.body,body_mask=document.querySelector(".body-mask"),audio_arr=[],last_arr=[];const react_reload=(e,t)=>{let i=document.createElement("div"),a=document.createElement("p"),s=document.createElement("img"),r=document.createElement("div"),l=document.createElement("h3"),d=document.createElement("p"),o=document.createElement("div"),n=document.createElement("img"),c=document.createElement("p"),m=document.createElement("div"),u=document.createElement("img"),_=document.createElement("div"),g=document.createElement("div"),y=document.createElement("div"),p=document.createElement("div");i.classList.add("main-music"),a.classList.add("main-music-num"),s.classList.add("main-music-img"),r.classList.add("main-music-author"),o.classList.add("main-music-love"),c.classList.add("main-music-time"),m.classList.add("main-music-menu"),_.classList.add("music-modal"),a.innerText=t.id+1,s.setAttribute("src",`./img/music-pic/${t.img}.jpg`),l.innerText=t.title,d.innerText=t.author,c.innerText="none",t.isLiked?n.setAttribute("src","./img/love-blue.png"):n.setAttribute("src","./img/love-gray.png"),u.setAttribute("src","./img/music-menu.png"),t.isLiked?g.innerText="Dislike":g.innerText="Like",y.innerText="add to playlist",p.innerText="listen now",_.append(g,y,p),m.append(u,_),o.append(n),r.append(l,d),i.append(a,s,r,o,c,m),e.append(i),n.onclick=()=>{audio_liked(t.id)},s.onclick=()=>{audio_play(t.id)},m.onclick=()=>{click_menu(t.id,_,i)},g.onclick=()=>{btn_like(t.id)},y.onclick=()=>{addPlaylist(t.id)}},reload_playlist=e=>{music_random.innerHTML="";for(const t of e)music_random&&react_reload(music_random,t)},reload_liked=e=>{music_liked.innerHTML="";for(const t of e)t.isLiked&&react_reload(music_liked,t)},reload_last=e=>{music_last.innerHTML="";for(const t of e)last_arr.length>0&&react_reload(music_last,t)};reload_playlist(musicId),reload_liked(musicId),reload_last(last_arr);let music_menu_modal=document.querySelectorAll(".music-modal"),music_music=document.querySelectorAll(".main-music"),modal=document.querySelector(".modal"),modal_cancel=document.querySelector(".modal-cancel");const audio_liked=e=>{let t=musicId.filter(t=>t.id==e)[0];t.isLiked=!t.isLiked,reload_playlist(musicId),reload_liked(musicId),reload_last(last_arr),aside_liked()},audio_play=e=>{let t=musicId.filter(t=>t.id==e)[0];music_play.setAttribute("src",`./img/music/${t.title_org}.mp3`),music_name.innerText=t.title,music_author.innerText=t.author,audio_arr.unshift(t),last_arr=audio_arr.filter((e,t)=>audio_arr.indexOf(e)==t),reload_last(last_arr),playAudio()},click_menu=(e,t,i)=>{i.classList.add("active"),t.classList.add("active"),body_mask.classList.add("active"),body.classList.add("hidden")},btn_like=e=>{let t=musicId.filter(t=>t.id==e)[0];t.isLiked=!t.isLiked,body_mask.classList.remove("active"),body.classList.remove("hidden"),reload_playlist(musicId),reload_liked(musicId),reload_last(last_arr),aside_liked()},addPlaylist=e=>{modal.classList.add("active")};body_mask.onclick=()=>{body_mask.classList.remove("active"),body.classList.remove("hidden");for(const e of music_menu_modal)e.classList.remove("active");for(const e of music_music)e.classList.remove("active");modal.classList.remove("active")},modal_cancel.onclick=()=>{modal.classList.remove("active"),body_mask.classList.remove("active"),body.classList.remove("hidden");for(const e of music_menu_modal)e.classList.remove("active");for(const e of music_music)e.classList.remove("active")};let playlist=document.querySelector(".playlist"),list_liked=document.querySelector(".aside_liked");const aside_reload=()=>{playlist.innerHTML="";for(const e of playlists){let t=document.createElement("div"),i=document.createElement("a");t.classList.add("list-link"),i.setAttribute("href","./playlist.html"),i.innerText=e.title,t.append(i),playlist.append(t)}},aside_liked=()=>{list_liked.innerHTML="";for(const e of musicId)if(1==e.isLiked){let t=document.createElement("div"),i=document.createElement("a"),a=document.createElement("span");t.classList.add("list-link"),t.classList.add("list-liked"),i.classList.add("list-link"),i.innerText=e.title,a.innerText="none",t.append(i,a),list_liked.append(t)}};aside_reload(),aside_liked();let search=document.querySelector(".search"),search_done=document.querySelector(".search-done"),search_arr=[];search.onkeyup=()=>{if(event.target.value.trim().length>=2){let e=musicId.filter(e=>e.title.trim().toLowerCase().includes(event.target.value.trim().toLowerCase())),t=musicId.filter(e=>e.author.trim().toLowerCase().includes(event.target.value.trim().toLowerCase()));search_arr=t.concat(e),search_arr=search_arr.filter((e,t)=>search_arr.indexOf(e)==t),search_reload(search_arr)}else search_arr=[],search_reload(search_arr)};const search_reload=e=>{if(search_done.innerHTML="",search_arr.length>=1){search_done.classList.add("active");for(const t of e){let e=document.createElement("div"),i=document.createElement("p"),a=document.createElement("p"),s=document.createElement("p");e.classList.add("search-done-item"),i.classList.add("title"),a.classList.add("author"),s.classList.add("time"),i.innerText=t.title,a.innerText=t.author,s.innerText="none",e.append(i,a,s),search_done.append(e),e.onclick=()=>{search_play(t.id)}}}else search_done.classList.remove("active")};search_reload(search_arr);const search_play=e=>{let t=musicId.filter(t=>t.id==e)[0];music_play.setAttribute("src",`./img/music/${t.title_org}.mp3`),music_name.innerText=t.title,music_author.innerText=t.author,audio_arr.unshift(t),last_arr=audio_arr.filter((e,t)=>audio_arr.indexOf(e)==t),reload_last(last_arr),playAudio()};let modal_box=document.querySelector(".modal-box"),modal_add=document.querySelector(".modal-add input"),btn_add=document.querySelector(".modal-btn");const modal_reload=()=>{modal_box.innerHTML="";for(const e of playlists){let t=document.createElement("div"),i=document.createElement("p"),a=document.createElement("span");t.classList.add("modal-box-item"),i.innerText=e.title,a.innerText=e.music.length+" songs",t.append(i,a),modal_box.append(t)}};modal_reload(),btn_add.onclick=()=>{if(modal_add.value.trim().length>=4){let e={title:modal_add.value.trim(),music:[]};playlists.push(e),btn_add.style.background="#00ECBE",modal_add.value=""}else btn_add.style.background="red";modal_reload(),aside_reload()};let replay=document.querySelector(".relpay"),prew=document.querySelector(".prew"),play=document.querySelector(".play"),play_src=document.querySelector(".play_src"),next=document.querySelector(".next"),any=document.querySelector(".any"),audioPlay=document.querySelector(".audio-play"),progress=document.querySelector(".progress"),timesong=document.querySelector(".timesong"),played=document.querySelector(".played"),progress_container=document.querySelector(".progress-container"),songsIndex=0,songsArr=musicId.map(e=>e.title_org),titleArr=musicId.map(e=>e.title),authorArr=musicId.map(e=>e.author);const playAudio=()=>{play.classList.add("active"),play_src.src="./img/pause.svg",audioPlay.play()},pauseAudio=()=>{play.classList.remove("active"),play_src.src="./img/play.svg",audioPlay.pause()};play.onclick=()=>{play.classList.contains("active")?(play.classList.remove("active"),play_src.src="./img/play.svg",audioPlay.pause()):playAudio()};const nextPlay=()=>{songsIndex>=songsArr.length-1?songsIndex=0:songsIndex++,music_name.innerText=titleArr[songsIndex],music_author.innerText=authorArr[songsIndex],audioPlay.src=`./img/music/${songsArr[songsIndex]}.mp3`,playAudio()};next.onclick=()=>{nextPlay()};const prewPlay=()=>{songsIndex<=0?songsIndex=songsArr.length-1:songsIndex--,music_name.innerText=titleArr[songsIndex],music_author.innerText=authorArr[songsIndex],audioPlay.src=`./img/music/${songsArr[songsIndex]}.mp3`,playAudio()};prew.onclick=()=>{songsIndex<=0?songsIndex=songsArr.length-1:songsIndex--,music_name.innerText=titleArr[songsIndex],music_author.innerText=authorArr[songsIndex],audioPlay.src=`./img/music/${songsArr[songsIndex]}.mp3`,playAudio()};const getProgress=e=>{let{duration:t,currentTime:i}=e.srcElement,a=i/t*100;progress.style.width=a+"%",timesong.innerText=(t/60).toFixed(1)+"min",played.innerText=""+(i/60).toFixed(1)};audioPlay.addEventListener("timeupdate",getProgress);const setProgress=e=>{let t=e.target.offsetWidth,i=e.offsetX,a=audioPlay.duration;audioPlay.currentTime=i/t*a};progress_container.addEventListener("click",setProgress),audioPlay.addEventListener("ended",nextPlay);